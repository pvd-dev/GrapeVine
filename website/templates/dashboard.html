
{% extends "theme.html" %} {% block title %}GrapeVine - Giving Feedback made easy{% endblock %} 



{% block Content%}


<div class="container"></div>
<br><br>
<!--Header of dasbhoard-->
<h1> {{ username }} // Dashboard</h1>

<hr>
<!--Splitting up in grid view for the graphs-->
<div class="row">
  <div class="col-sm-4 ">
    <div class="row">
      <div class="jumbotron jumbotron-fluid rounded bg-light">
        <div class="container">
          <br><br>
          <h1 class="display-4">{{ grapevinescore }}</h1>
          <p class="lead">Grapevine Score</p>
          <p>We recalculated your responses into a NPS style score</p>
        </div>
      </div>
    <br>
    
    </div>
    
  </div>
  <div class="col-sm-4 height=100%">
    <div class="row">
      <div class="jumbotron jumbotron-fluid rounded bg-light ">
        <div class="container">
          <br><br>
          <h1 class="display-4">{{ totalresponses }}</h1>
          <p class="lead">Total responses</p>
          <p>The total of all the feedback you have received</p>
        </div>
      </div>
    <br>
    
    </div>
    
  </div>

  <div class="col-sm-4">
    <div class="row">
      <div class="jumbotron jumbotron-fluid rounded bg-light ">
        <div class="container">
          <p class="lead">Get your feedback templates now</p>
          <p>Start asking your clients for feedback, by forwarding them one of our templates. We'll send you a ready-to-send copy that you can forward easily. </p>
          <br>
          <div class="btn-group" role="group" aria-label="Button group with nested dropdown">
            <button type="button" class="btn btn-primary text-dark" data-bs-toggle="offcanvas" data-bs-target="#offcanvasEmail" aria-controls="offcanvasEmail">Email</button>
            <button type="button" class="btn btn-primary text-dark" data-bs-toggle="offcanvas" data-bs-target="#offcanvasWhatsapp" aria-controls="offcanvasWhatsapp">Whatsapp</button>
          
            <div class="btn-group" role="group">
              <button id="btnGroupDrop1" type="button" class="btn btn-primary dropdown-toggle text-dark" data-bs-toggle="dropdown" aria-expanded="false">
                QR Codes
              </button>
              <ul class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                <li><a class="dropdown-item text-dark " href="#">Download our PDF Template</a></li>
                <li><a class="dropdown-item text-dark" href="#">Download only the QR codes</a></li>
              </ul>
              <br>
            </div>
          </div>
        </div>
      </div>
    <br>
    
    </div>
    
  </div>
  
  <div class="row">
  <div class="col-12">

    <!--Drawing the bar chart-->
    {% if totalresponses  > 0 %}

    <canvas id="lineChart" width="900" height="200"></canvas>
    <script>
      var ctx = document.getElementById("lineChart").getContext("2d");
      var lineChart = new Chart(ctx, {
        type: "bar",
        data: {
          labels: {{ labels | safe }},
          datasets: [
            {
            data: {{ values |safe }},
            fill: true,
            backgroundColor: [
              'rgb(180, 231, 218)',
              'rgb(245, 228, 81)',
              'rgb(172, 173, 200)'
            ],
            },
          ]
        },
        options: {
          responsive: true,
          legend: {
            display: false
          }
        }
      });
    </script></div>
    {% else %}


    
    {% endif%}
</div>
</div>
<!-- Drawing the doughnut chart-->
{% if totalresponses  > 0 %}
<div class="row justify-content-between">
  <hr>
  <div class="col-sm-4"><canvas id="pieChart" width="900" height="200"></canvas>
    <script>
      var ctx = document.getElementById("pieChart").getContext("2d");
      var pieChart = new Chart(ctx, {
        type: "doughnut",
        data: {
          labels: {{ labels | safe }},
          datasets: [
            {
              backgroundColor: [
              'rgb(180, 231, 218)',
              'rgb(245, 228, 81)',
              'rgb(172, 173, 200)'
            ],
            label: " Score",
            data: {{ values |safe }},
            fill: false,
            lineTension: 0.5
            },
          ]
        },
        options: {
          responsive: true
        }
      });
    </script></div>
{% else %}
<br><br>
<hr>
<h1> You have received no feedback yet</h1>
<p>As soon as your first customers start interacting with your surveys the results will show up here.</p>

{% endif%}

  <div class="col-sm-8"><div id="posts"></br >
    {% if totalresponses  > 0 %}
    <h2> What your users are saying:</h2><br>
    {% for post in posts %}
    <div class="card border-grey">
        {% if post.rating > 2 %}
        <div class="card-header d-flex bg-primary justify-content-between align-items-center">
        <h1><i class="far fa-smile" color-primary></i></h1> From customer: {{post.email}}
        {%elif post.rating > 1 %}
        <div class="card-header d-flex bg-secondary justify-content-between align-items-center">
        <h1><i class="far fa-meh" bg-primary></i></h1> From customer: {{post.email}}
        {%elif post.rating < 2 %}
        <div class="card-header d-flex bg-third justify-content-between align-items-center">
        <h1><i class="far fa-frown" bg-primary></i></h1> From customer: {{post.email}}
        {%endif%}
        <div>
          <span id="likes-count-{{post.id}}">
          {{ post.likes|length }}</span> 
          {% if user.id in post.likes|map(attribute="author")|list %}
          <i
            class="fas fa-thumbs-up"
            id="like-button-{{post.id}}"
            onclick="like({{post.id}})"
          ></i>
          {% else %}
          <i
            class="far fa-thumbs-up"
            id="like-button-{{post.id}}"
            onclick="like({{post.id}})"
          ></i>
          {% endif %} {% if user.id == post.author %}
          <div class="btn-group">
            <button
              type="button"
              class="btn btn-sm btn-dark dropdown-toggle"
              data-bs-toggle="dropdown"
            ></button>
            <ul class="dropdown-menu">
              <li>
                <a href="/delete-post/{{post.id}}" class="dropdown-item"
                  >Delete</a
                >
              </li>
            </ul>
          </div>
          {% endif %}
        </div>
      </div>
      <div class="card-body">
        <div class="card-text"><h3><b>{{post.text}}</b></h3></div>
        <br />
        <div class="collapse text-dark" id="comments-{{post.id}}">
          <div class="card">
            <div class="card-body" id="comments-expanded-{{post.id}}">
              {% for comment in post.comments %}
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <a href="/posts/{{comment.user.username}}"
                    >{{comment.user.username}}</a
                  >: {{comment.text}}
                </div>
                <div>
                  <small class="text-muted"> {{comment.date_created}}</small>
                  {% if user.id == comment.author or user.id == post.author %}
                  <div class="btn-group">
                    <button
                      type="button"
                      class="btn btn-sm btn-dark dropdown-toggle"
                      data-bs-toggle="dropdown"
                    ></button>
                    <ul class="dropdown-menu">
                      <li>
                        <a
                          href="/delete-comment/{{comment.id}}"
                          class="dropdown-item"
                          >Delete</a
                        >
                      </li>
                    </ul>
                  </div>
                  {% endif %}
                </div>
              </div>
              {% endfor %}
            </div>
          </div>
        </div>
        <p class="card-text">
          {% if totalresponses > 0 %}
          <a data-bs-toggle="collapse" href="#comments-{{post.id}}" role="button">
            <small class="text-dark">View {{post.comments|length}} Comments</small>
          </a>
          {% else %}
          <small class="text-muted">No Comments</small>
          {% endif %}
        </p>
        <form
          class="input-group mb-3"
          method="POST"
          action="/create-comment/{{post.id}}"
        >
          <input
            type="text"
            id="text"
            name="text"
            class="form-control"
            placeholder="Comment something!"
          />
          <button type="submit" class="btn btn-dark">Comment</button>
        </form>
      </div>
      <div class="card-footer text-muted">{{post.date_created}}</div>
    </div>
  </br > {% endfor %}
  </div> 
  {% else %}
  <!-- If there are 0 posts we show this accordion helping the user getting started-->
  <h2>Get started in 3 simple steps:</h2>
  <div class="accordion" id="accordionPanelsStayOpenExample">
    <div class="accordion-item">
      <h2 class="accordion-header" id="panelsStayOpen-headingOne">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true" aria-controls="panelsStayOpen-collapseOne">
          Accordion Item #1
        </button>
      </h2>
      <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingOne">
        <div class="accordion-body">
          <strong>This is the first item's accordion body.</strong> It is shown by default, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the showing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the <code>.accordion-body</code>, though the transition does limit overflow.
        </div>
      </div>
    </div>
    <div class="accordion-item">
      <h2 class="accordion-header" id="panelsStayOpen-headingTwo">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo">
          Accordion Item #2
        </button>
      </h2>
      <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingTwo">
        <div class="accordion-body">
          <strong>This is the second item's accordion body.</strong> It is hidden by default, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the showing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the <code>.accordion-body</code>, though the transition does limit overflow.
        </div>
      </div>
    </div>
    <div class="accordion-item">
      <h2 class="accordion-header" id="panelsStayOpen-headingThree">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="false" aria-controls="panelsStayOpen-collapseThree">
          Accordion Item #3
        </button>
      </h2>
      <div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingThree">
        <div class="accordion-body">
          <strong>This is the third item's accordion body.</strong> It is hidden by default, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the showing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the <code>.accordion-body</code>, though the transition does limit overflow.
        </div>
      </div>
    </div>
  </div>
  {% endif %}   

</div>
</div>
  
</div>


</div>

<!-- These 2 offcanvas items manage the sliding in of information when users tap the whatsapp and Email buttons-->
<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasWhatsapp" aria-labelledby="offcanvasWhatsapp">
  <div class="offcanvas-header">
    <h3 id="offcanvasWhatsapp">How to get feedback through Whatsapp</h3>
    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">
    <p><i>You can simply receive feedback through whatsapp using our pre-made whatsapp template it works super simple:</i></p>
    <hr>
    <h5>Step 1: Send the template to your phone</h5>
    <p>Grapevine will send you template on your phone, all you have to do is tap this button:</p>
    <button type="button" class="btn btn-primary text-dark">Send the Whatsapp template to my phone</button>
    <br>    <br>    <br>
    <img class="app-badge center-block" src="{{ url_for('static',filename='assets/img/chat.png') }}" alt="..." style="max-width: 50%"/>
    <br>
    <br>
    <hr>

    <br>
    <h5>Step 2: Share the template with contacts in your phone </h5>
    <li>Simply hold your finger on the message in Whatsapp, and a menu will pop up. </li>
   <li>Tap "forward" and select the contacts you want to ask for feedback</li>>
    <img class="app-badge center-block" src="{{ url_for('static',filename='assets/img/sharing.jpeg') }}" alt="..." style="max-width: 50%"/>
    <br>
    <br>
    <hr>
    <h5>Or: Copy + paste and make it your own</h5>
    <p>If you want to ask for feedback anywhere else, simply copy paste the template and make it your own!</p>
    <pre><code>
      Hi 

      dhdhdaldi
      data-sb-feedbackdd

      data-device
    </code></pre>
  </div>
</div>
<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasEmail" aria-labelledby="offcanvasEmail">
  <div class="offcanvas-header">
    <h3 id="offcanvasWhatsapp">How to get feedback through Email</h3>
    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">
    <p></p><i>You can simply receive feedback through email using our pre-made email template it works super simple:</i></p>
    <hr>
    <h5>Method 1: Send the template to your mailbox</h5>
    <p>Grapevine will send your template to your mailbox on the email address you used during signup, all you have to do is tap this button:</p>
    <button type="button" class="btn btn-primary text-dark">Send the template to <b>my</b> email address</button>
    <br>
    <br>
    <hr>
    <br>
    <h5>Method 2: Send the feedback template to your contacts directly</h5>
    <p>Grapevine can also send the email template to one of your contacts directly. Simply add the email address of your recipients and hit send.</p>
    <div class="input-group mb-3">
      <input type="text" class="form-control" placeholder="Email address of your recipient" aria-label="Recipient's username" aria-describedby="button-addon2">
      <button class="btn btn-primary text-dark" type="button" id="button-addon2">Send to client</button>
    </div>
    <small>Did you know you can add multiple recipients by separating email addresses using commas?</small>
    <br>
    <br>
    <hr>
    <br>
    <h5>Method 3: Copy + paste and make it your own</h5>
    <p>If you want to ask for feedback anywhere else, simply copy paste the template and make it your own!</p>
    <pre><code>
      Hi 

      dhdhdaldi
      data-sb-feedbackdd

      data-device
    </code></pre>
  </div>
</div>



{% endblock%}
        